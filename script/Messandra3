const axios = require('axios');

module.exports.config = {
  name: 'aria',
  version: '1.0.0',
  hasPermission: 0,
  usePrefix: false,
  aliases: ['aria', 'askaria'],
  description: "Chat with Aria AI via Betadash API.",
  usages: "aria [message]",
  cooldowns: 0,
  dependencies: { "axios": "" }
};

module.exports.run = async function({ api, event, args }) {
  const input = args.join(' ').trim();

  if (!input) {
    return api.sendMessage(
      "Hi! I’m Aria AI. Please type a message to start chatting.",
      event.threadID,
      event.messageID
    );
  }

  api.sendMessage("⌛ Sending your question to Aria...", event.threadID, event.messageID);

  try {
    const response = await axios.get('https://betadash-api-swordslush-production.up.railway.app/Aria', {
      params: { ask: input }
    });

    if (!response.data) {
      return api.sendMessage("⚠️ Aria didn't respond. Please try again.", event.threadID, event.messageID);
    }

    return api.sendMessage(response.data, event.threadID, event.messageID);

  } catch (error) {
    console.error("Error contacting Aria API:", error.message || error);
    return api.sendMessage("⚠️ Error contacting Aria. Try again later.", event.threadID, event.messageID);
  }
};
